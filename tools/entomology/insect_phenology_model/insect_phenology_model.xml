<tool id="insect_phenology_model" name="Insect phenology model" version="1.1.0">
    <description>expressing stage-specific phenology and population dynamics</description>
    <requirements>
        <requirement type="package" version="1.4.4">r-optparse</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
Rscript '$__tool_directory__/insect_phenology_model.R'
--adult_mortality $adult_mortality
--adult_accumulation $adult_accumulation
--egg_mortality $egg_mortality
--input '$input'
--insect '$insect'
--insects_per_replication $insects_per_replication
--location '$location'
--max_clutch_size $max_clutch_size
--min_clutch_size $min_clutch_size
--nymph_mortality $nymph_mortality
--num_days $input.metadata.data_lines
--old_nymph_accumulation $old_nymph_accumulation
--output '$output'
--oviposition $oviposition
--photoperiod $photoperiod
--replications $replications
--std_error_plot $std_error_plot
--young_nymph_accumulation $young_nymph_accumulation]]></command>
    <inputs>
        <param name="input" type="data" format="csv" label="Temperature data" />
        <param name="location" type="text" value="" optional="false" label="Location" />
        <param name="insect" type="select" label="Select insect">
            <option value="Brown Marmolated Stink Bug" selected="True">Brown Marmolated Stink Bug</option>
        </param>
        <param name="replications" type="integer" value="10" min="1" label="Number of replications" />
        <param name="insects_per_replication" type="integer" value="1000" min="1" label="Number of insects with which to start each replication" />
        <param name="photoperiod" type="float" value="13.5" min="0" label="Critical photoperiod for diapause induction/termination" />
        <param name="egg_mortality" type="integer" value="1" min="0" label="Adjustment rate for egg mortality" />
        <param name="nymph_mortality" type="integer" value="1" min="0" label="Adjustment rate for nymph mortality" />
        <param name="adult_mortality" type="integer" value="1" min="0" label="Adjustment rate for adult mortality" />
        <param name="oviposition" type="integer" value="1" min="0" label="Adjustment oviposition rate" />
        <param name="min_clutch_size" type="integer" value="0" min="0" label="Adjustment of minimum clutch size" />
        <param name="max_clutch_size" type="integer" value="0" min="0" label="Adjustment of maximum clutch size" />
        <param name="young_nymph_accumulation" type="integer" value="0" min="0" label="Adjustment of degree-days accumulation (egg->young nymph)" />
        <param name="old_nymph_accumulation" type="integer" value="0" min="0" label="Adjustment of degree-days accumulation (young nymph->old nymph)" />
        <param name="adult_accumulation" type="integer" value="0" min="0" label="Adjustment of degree-days accumulation (old nymph->adult)" />
        <param name="std_error_plot" type="select" label="Plot standard error?">
            <option value="1" selected="True">Yes</option>
            <option value="0">No</option>
        </param>
    </inputs>
    <outputs>
        <data name="output" format="pdf" label="${tool.name} ${location}, on ${on_string}" />
    </outputs>
    <tests>
        <test>
            <param name="input" value="state_college.csv" ftype="csv" />
            <param name="location" value="State College PA" />
            <param name="replications" value="10" />
            <output name="output" file="output.pdf" ftype="pdf" compare="contains" />
        </test>
    </tests>
    <help>
**What it does**

Provides an agent-based stochastic model expressing stage-specific phenology and population dynamics for an insect species across geographic regions.

-----

**Required options**

 * **Location** - the location associated with the selected temperature data.
 * **Temperature data** - select the dataset from your history containing the temperature data.
 * **Select insect** - currently only the Brown Marmolated Stink Bug can be analyzed.
 * **Number of replications** - number of replications.
 * **Number of insects with which to start each replication** - the analysis for each replication will start with this number of insects.
 * **Critical photoperiod for diapause induction/termination** - critical photoperiod for diapause induction/termination.
 * **Adjustment rate for egg mortality** - adjustment rate for egg mortality.
 * **Adjustment rate for nymph mortality** - adjustment rate for nymph mortality.
 * **Adjustment rate for adult mortality** - adjustment rate for adult mortality.
 * **Adjustment oviposition rate** - adjustment oviposition rate.
 * **Adjustment of minimum clutch size** - adjustment of minimum clutch size.
 * **Adjustment of maximum clutch size** - adjustment of maximum clutch size
 * **Adjustment of degree-days accumulation (egg->young nymph)** - adjustment of degree-days accumulation (egg->young nymph).
 * **Adjustment of degree-days accumulation (young nymph->old nymph)** - adjustment of degree-days accumulation (young nymph->old nymph).
 * **Adjustment of degree-days accumulation (old nymph->adult)** - adjustment of degree-days accumulation (old nymph->adult).
 * **Plot standard error** - add standard error lines to plot.

    </help>
    <citations>
        <citation type="doi">10.3389/fphys.2016.00165</citation>
        <citation type="doi">10.1175/JTECH-D-11-00103.1</citation>
        <citation type="doi">10.7289/V5D21VHZ</citation>
    </citations>
</tool>
