<tool id="plant_tribes_gene_family_integrator" name="GeneFamilyIntegrator" version="0.8.0">
    <description>integrates de novo assembly sequences with scaffold gene family sequences</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements_gene_family_integrator" />
    <expand macro="stdio" />
    <command>
        <![CDATA[
            #set input_format = $input_format_cond.input_format
            #set scaffold = $input_format_cond.scaffold
            #set method = $input_format_cond.method

            python $__tool_directory__/gene_family_integrator.py
            --scaffold '$scaffold.fields.path'
            --method $method
            #if str($input_format) == 'ptortho':
                --orthogroup_faa '$input_format_cond.input_ptortho.extra_files_path'
                --output '$output_ptortho'
                --output_dir '$output_ptortho.files_path'
            #else:
                ## str($input_format) == 'ptorthocs'
                --orthogroup_faa '$input_format_cond.input_ptorthocs.extra_files_path'
                #if str($input_format_cond.orthogroup_fna) == 'yes':
                    --orthogroup_fna 'true'
                    --output '$output_ptorthocs'
                    --output_dir '$output_ptorthocs.files_path'
                #else:
                    --output '$output_ptortho'
                    --output_dir '$output_ptortho.files_path'
                #end if
            #end if
        ]]>
    </command>
    <inputs>
        <conditional name="input_format_cond">
            <param name="input_format" type="select" label="Select type of data to sub sample">
                <option value="ptortho">Gene family clusters</option>
                <option value="ptorthocs">Gene family clusters with corresponding coding sequences</option>
            </param>
            <when value="ptortho">
                <param name="input_ptortho" format="ptortho" type="data" label="Gene family clusters" />
                <expand macro="param_scaffold" />
                <expand macro="param_method" />
            </when>
            <when value="ptorthocs">
                <param name="input_ptorthocs" format="ptorthocs" type="data" label="Gene family clusters with corresponding coding sequences" />
                <expand macro="param_scaffold" />
                <expand macro="param_method" />
                <expand macro="param_orthogroup_fna" />
            </when>
        </conditional>
    </inputs>
    <outputs>
        <data name="output_ptortho" format="ptortho" label="Integrated gene family clusters on ${on_string}">
            <filter>input_format_cond['input_format'] == 'ptortho' or (input_format_cond['input_format'] == 'ptorthocs' and input_format_cond['orthogroup_fna'] == 'no')</filter>
        </data>
        <data name="output_ptorthocs" format="ptorthocs" label="Integrated gene family clusters and corresponding coding sequences on ${on_string}">
            <filter>input_format_cond['input_format'] == 'ptorthocs' and input_format_cond['orthogroup_fna'] == 'yes'</filter>
        </data>
    </outputs>
    <tests>
        <test>
        </test>
    </tests>
    <help>
This tool is one of the PlantTribes collection of automated modular analysis pipelines for comparative and evolutionary
analyses of genome-scale gene families and transcriptomes. This tool integrates classified post processed de novo transcriptome
assembly sequence(s) with the scaffold gene family sequences.

-----

**Required options**

 * **Gene family clusters** - sequences classified into gene family clusters, optionally including corresponding coding sequences.
 * **Gene family scaffold** - one of the PlantTribes gene family scaffolds [2-4] installed into Galaxy by the PlantTribes Scaffold Data Manager tool.
 * **Protein clustering method** - gene family scaffold protein clustering method as described in the AssemblyPostProcessor tool.

**Other options**

 * **Process corresponding gene family classification orthogroups CDS fasta files** - Select 'Yes' top process corresponding gene family classification orthogroups CDS fasta files.

    </help>
    <citations>
        <expand macro="citation1" />
        <expand macro="citations2to4" />
    </citations>
</tool>
